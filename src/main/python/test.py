from tensorflow.keras.models import load_model
from tensorflow.keras.preprocessing.sequence import pad_sequences
import pickle

# Параметры (те же, что при обучении)
max_len = 100  # должна совпадать с твоим max_len

# Загружаем модель (если скачал и загрузил в текущую сессию)
model = load_model('lead_classifier_model.keras')

# Загружаем tokenizer (нужно заранее загрузить файл tokenizer.pickle в Colab)
with open('tokenizer.pickle', 'rb') as handle:
    tokenizer = pickle.load(handle)

def predict_lead(text):
    seq = tokenizer.texts_to_sequences([text])
    padded = pad_sequences(seq, maxlen=max_len)
    pred = model.predict(padded)[0][0]
    return 'Лид' if pred > 0.5 else 'Не лид'

# Примеры для проверки
texts_to_check = [
    "куплю дом в геленджике",
    "сдам жильё в анапе",
    "ищу квартиру на юге",
    "продаю дачу",
    "куплю дом с участком",
    "куплю квартиру в новостройке",
    "сдам квартиру в сочи",
    "ищу квартиру недорого",
    "продаю квартиру в краснодаре",
    "куплю дачу у моря",
    "сдам комнату в туапсе",
    "ищу жильё для семьи",
    "продаю земельный участок",
    "куплю квартиру с ремонтом",
    "сдам офис в центре города",
    "ищу дом на побережье",
    "продаю гараж",
    "куплю квартиру в центре",
    "сдам квартиру посуточно",
    "ищу жильё в курортной зоне",
    "продаю коммерческую недвижимость",
    "куплю квартиру с видом на море",
    "сдам квартиру в анапе на лето",
    "ищу дачу недалеко от города",
    "продаю земельный участок под строительство",
    "куплю дом в тихом районе",
    "сдам квартиру студентам",
    "ищу жильё с парковкой",
    "продаю квартиру с мебелью",
    "куплю квартиру в краснодаре",
    "сдам комнату в геленджике",
    "ищу дом с садом",
    "продаю квартиру в новостройке",
    "куплю квартиру эконом класса",
    "сдам квартиру на длительный срок",
    "ищу жильё рядом с морем",
    "продаю коммерческое помещение",
    "куплю дом с бассейном",
    "сдам квартиру после ремонта",
    "ищу квартиру для инвестиций",
    "продаю дом с участком",
    "куплю квартиру в пригороде",
    "сдам гараж в аренду",
    "ищу жильё с хорошей инфраструктурой",
    "продаю дачу в краснодарском крае",
    "куплю квартиру с балконом",
    "сдам квартиру недорого",
    "ищу дом в новостройке",
    "продаю квартиру без посредников",
    "куплю яблоки в магазине",
    "Да знаю я ",
    "Спустить с 4 этажа старый диван и погрузить в машину."
]

for text in texts_to_check:
    result = predict_lead(text)
    print(f"Текст: {text}\nРезультат: {result}\n")
